

CREATE TABLE callcenter
    (`Id` int primary key, `From_number` int, `Start_time` datetime, `End_time` datetime, `Duration` int)
;
    
INSERT INTO callcenter
    (`Id`, `From_number`, `Start_time`, `End_time`, `Duration`)
VALUES
    (1, 99999000, '2021-01-13 06:00:05', '2021-01-13 06:00:46', 41),
    (2, 99999010, '2021-01-13 06:12:49', '2021-01-13 06:13:24', 35),
    (3, 99913232, '2021-01-13 07:02:49', '2021-01-13 07:03:36', 47),
    (4, 84848484, '2021-01-13 08:12:49', '2021-01-13 08:13:17', 28),
    (5, 78373737, '2021-01-13 10:12:49', '2021-01-13 10:14:19', 130),
    (6, 37373737, '2021-01-13 12:12:49', '2021-01-13 12:14:06', 117),
    (7, 73737373, '2021-01-13 15:12:49', '2021-01-13 15:13:03', 14),
    (8, 33782446, '2021-01-26 20:17:39', '2021-01-26 20:18:04', 25),
    (9, 11938519, '2021-01-15 11:53:59', '2021-01-15 11:55:15', 116),
    (10, 22789812, '2021-01-26 05:25:42', '2021-01-26 05:26:00', 18),
    (11, 25559758, '2021-01-28 06:01:31', '2021-01-28 06:02:17', 46),
    (12, 80527095, '2021-01-18 03:36:27', '2021-01-18 03:37:43', 116),
    (13, 99977019, '2021-01-16 00:17:57', '2021-01-16 00:18:44', 47),
    (14, 74819553, '2021-01-18 07:12:03', '2021-01-18 07:13:38', 135),
    (15, 21778340, '2021-01-17 00:06:17', '2021-01-17 00:07:04', 47),
    (16, 40412452, '2021-01-19 19:10:03', '2021-01-19 19:10:43', 40),
    (17, 71831542, '2021-01-20 13:13:32', '2021-01-20 13:14:27', 55),
    (18, 10872622, '2021-01-25 16:45:41', '2021-01-25 16:46:35', 54),
    (19, 74174045, '2021-01-20 17:25:13', '2021-01-20 17:26:52', 139),
    (20, 99521547, '2021-01-23 22:06:57', '2021-01-23 22:07:40', 43),
    (21, 23343027, '2021-01-17 09:24:05', '2021-01-17 09:24:12', 7),
    (22, 47823545, '2021-01-24 13:34:13', '2021-01-24 13:35:45', 132),
    (23, 98560122, '2021-01-27 15:12:22', '2021-01-27 15:13:16', 54),
    (24, 42230461, '2021-01-21 08:46:08', '2021-01-21 08:47:33', 125),
    (25, 15337644, '2021-01-18 15:44:19', '2021-01-18 15:45:27', 108),
    (26, 11341066, '2021-01-23 14:05:44', '2021-01-23 14:07:04', 120),
    (27, 77441434, '2021-01-13 16:09:06', '2021-01-13 16:10:42', 136),
    (28, 69317702, '2021-01-20 22:00:27', '2021-01-20 22:01:11', 44),
    (29, 20063449, '2021-01-23 18:45:31', '2021-01-23 18:45:54', 23),
    (30, 57346177, '2021-01-29 00:19:59', '2021-01-29 00:21:12', 113),
    (31, 90063425, '2021-01-22 15:29:06', '2021-01-22 15:29:12', 6),
    (32, 55004918, '2021-01-14 13:12:07', '2021-01-14 13:13:37', 130),
    (33, 64036378, '2021-01-14 01:27:19', '2021-01-14 01:28:07', 48),
    (34, 21646926, '2021-01-29 14:49:04', '2021-01-29 14:50:05', 101),
    (35, 34964170, '2021-01-25 14:25:18', '2021-01-25 14:26:19', 101),
    (36, 69496904, '2021-01-17 06:38:17', '2021-01-17 06:38:37', 20),
    (37, 57636705, '2021-01-23 06:18:40', '2021-01-23 06:18:48', 8),
    (38, 84037636, '2021-01-19 22:09:08', '2021-01-19 22:10:19', 111),
    (39, 44842071, '2021-01-14 14:04:27', '2021-01-14 14:05:08', 41),
    (40, 95660605, '2021-01-23 06:01:26', '2021-01-23 06:02:45', 119),
    (41, 56281959, '2021-01-14 03:29:12', '2021-01-14 03:30:33', 121),
    (42, 47555166, '2021-01-18 02:09:43', '2021-01-18 02:10:48', 105),
    (43, 97010524, '2021-01-13 19:40:45', '2021-01-13 19:42:04', 119),
    (44, 15203514, '2021-01-25 04:25:57', '2021-01-25 04:27:37', 140),
    (45, 15771993, '2021-01-23 13:05:15', '2021-01-23 13:06:21', 106),
    (46, 62836242, '2021-01-18 02:45:21', '2021-01-18 02:45:45', 24),
    (47, 51940683, '2021-01-25 16:33:23', '2021-01-25 16:33:38', 15),
    (48, 21346812, '2021-01-26 11:45:09', '2021-01-26 11:46:42', 133),
    (49, 38123257, '2021-01-21 12:16:19', '2021-01-21 12:16:53', 34),
    (50, 32220576, '2021-01-15 17:22:54', '2021-01-15 17:24:10', 116),
    (51, 69081622, '2021-01-14 13:47:07', '2021-01-14 13:48:28', 121),
    (52, 22565664, '2021-01-28 19:28:05', '2021-01-28 19:29:25', 120),
    (53, 70129921, '2021-01-21 15:48:30', '2021-01-21 15:49:28', 58),
    (54, 30155855, '2021-01-13 15:07:49', '2021-01-13 15:08:32', 43),
    (55, 98443321, '2021-01-21 11:10:59', '2021-01-21 11:11:36', 37),
    (56, 15639383, '2021-01-18 14:17:23', '2021-01-18 14:18:12', 49),
    (57, 85493837, '2021-01-21 12:50:30', '2021-01-21 12:51:05', 35),
    (58, 21683894, '2021-01-23 05:22:06', '2021-01-23 05:22:31', 25),
    (59, 35049506, '2021-01-28 20:24:29', '2021-01-28 20:24:42', 13),
    (60, 70785559, '2021-01-24 13:25:17', '2021-01-24 13:26:36', 119),
    (61, 29480112, '2021-01-20 09:19:01', '2021-01-20 09:20:07', 106),
    (62, 23052067, '2021-01-27 18:12:43', '2021-01-27 18:14:11', 128),
    (63, 72668247, '2021-01-29 08:09:27', '2021-01-29 08:10:15', 48),
    (64, 73228134, '2021-01-25 01:04:13', '2021-01-25 01:05:17', 104),
    (65, 37320338, '2021-01-25 04:54:08', '2021-01-25 04:55:25', 117),
    (66, 50033205, '2021-01-18 21:29:37', '2021-01-18 21:31:10', 133),
    (67, 14747855, '2021-01-25 14:14:27', '2021-01-25 14:15:04', 37),
    (68, 29910374, '2021-01-17 15:07:09', '2021-01-17 15:08:43', 134),
    (69, 35566418, '2021-01-14 01:04:49', '2021-01-14 01:05:56', 107),
    (70, 65685710, '2021-01-17 14:26:17', '2021-01-17 14:27:05', 48),
    (71, 47050135, '2021-01-21 10:35:06', '2021-01-21 10:35:40', 34),
    (72, 30278528, '2021-01-14 09:09:20', '2021-01-14 09:09:42', 22),
    (73, 32946727, '2021-01-21 16:40:24', '2021-01-21 16:42:01', 137),
    (74, 53481052, '2021-01-16 04:22:44', '2021-01-16 04:23:16', 32),
    (75, 19619474, '2021-01-21 15:07:13', '2021-01-21 15:08:11', 58),
    (76, 91440502, '2021-01-14 17:51:35', '2021-01-14 17:53:06', 131),
    (77, 60794324, '2021-01-26 21:14:05', '2021-01-26 21:15:33', 128),
    (78, 32127636, '2021-01-15 12:42:32', '2021-01-15 12:43:40', 108),
    (79, 63276159, '2021-01-26 12:20:18', '2021-01-26 12:21:27', 109),
    (80, 13098324, '2021-01-17 10:02:06', '2021-01-17 10:02:46', 40),
    (81, 53577069, '2021-01-16 18:52:51', '2021-01-16 18:54:14', 123)
;

select HOUR(End_time) as Hour, count(Hour(End_time)) as TotalCalls from callcenter group by Hour order by TotalCalls desc limit 1;
select HOUR(End_time) as Hour, sum(Duration) as TotalDuration from callcenter group by Hour order by TotalDuration desc limit 1;
select DAYOFWEEK(End_time) as DayOfWk, count(DAYOFWEEK(End_time)) as TotalCalls from callcenter group by DayOfWk order by TotalCalls desc limit 1;
select DAYOFWEEK(End_time) as DayOfWk, sum(Duration) as TotalDuration from callcenter group by DayOfWk order by TotalDuration desc limit 1;